{
  "version": 3,
  "sources": ["../lib/base.js"],
  "sourcesContent": ["export function subscription() {\n    const subscribers = []\n    return {\n        $SUBSCRIPTION: true,\n        $subscribe(subscriber) {\n            subscribers.push(subscriber)\n        },\n        $publish(...data) {\n            subscribers.forEach(subscriber => subscriber(...data))\n        },\n    }\n}\n\nexport function makeSubscription(value) {\n    if (typeof value === \"object\") {\n        if (Array.isArray(value)) {\n            return group(value)\n        } else {\n            return store(value)\n        }\n    }\n\n    return reactive(value)\n}\n\nexport function reactive(value) {\n    const { $subscribe, $publish } = subscription()\n    return {\n        $SUBSCRIPTION: true,\n        $subscribe,\n        $static() {\n            return value\n        },\n        $get() {\n            return value\n        },\n        $set(newValue) {\n            value = newValue\n            $publish(newValue)\n        }\n    }\n}\n\nexport function group(initial = []) {\n    const { $subscribe, $publish } = subscription()\n\n    const _group = []\n\n    for (let i = 0; i < initial.length; i++) {\n        const item = makeSubscription(initial[i])\n        _group.push(item)\n        item.$subscribe((newValue, keyParts) => {\n            $publish(newValue, keyParts ? `${i}.${keyParts}` : `${i}`)\n        })\n    }\n\n    _group.$SUBSCRIPTION = true\n    _group.$subscribe = $subscribe\n    _group.$static = function () {\n        return _group.map(item => item.$static())\n    }\n    _group.$mutate = function (fn) {\n        fn(_group)\n        for (let i = 0; i < _group.length; i++) {\n            if (!_group[i].$SUBSCRIPTION) {\n                _group[i] = makeSubscription(_group[i])\n            }\n        }\n        $publish(_group.$static())\n    }\n\n    return _group\n}\n\nexport function store(initial = {}) {\n    const { $subscribe, $publish } = subscription()\n\n    const _store = {}\n\n    for (const key in initial) {\n        _store[key] = makeSubscription(initial[key])\n        _store[key].$subscribe((newValue, keyParts) => {\n            $publish(newValue, keyParts ? `${key}.${keyParts}` : key)\n        })\n    }\n\n    _store.$SUBSCRIPTION = true\n    _store.$subscribe = $subscribe\n    _store.$static = function () {\n        const _static = {}\n        for (const key in _store) {\n            if (!key.startsWith(\"$\")) {\n                _static[key] = _store[key].$static()\n            }\n        }\n        return _static\n    }\n    _store.$set = function (key, value) {\n        _store[key] = makeSubscription(value)\n        _store[key].$subscribe((newValue, keyParts) => {\n            $publish(newValue, keyParts ? `${key}.${keyParts}` : key)\n        })\n        $publish(_store[key].$static(), key)\n    }\n\n    return _store\n}\n"],
  "mappings": "MAAO,SAASA,GAAe,CAC3B,IAAMC,EAAc,CAAC,EACrB,MAAO,CACH,cAAe,GACf,WAAWC,EAAY,CACnBD,EAAY,KAAKC,CAAU,CAC/B,EACA,YAAYC,EAAM,CACdF,EAAY,QAAQC,GAAcA,EAAW,GAAGC,CAAI,CAAC,CACzD,CACJ,CACJ,CAEO,SAASC,EAAiBC,EAAO,CACpC,OAAI,OAAOA,GAAU,SACb,MAAM,QAAQA,CAAK,EACZC,EAAMD,CAAK,EAEXE,EAAMF,CAAK,EAInBG,EAASH,CAAK,CACzB,CAEO,SAASG,EAASH,EAAO,CAC5B,GAAM,CAAE,WAAAI,EAAY,SAAAC,CAAS,EAAIV,EAAa,EAC9C,MAAO,CACH,cAAe,GACf,WAAAS,EACA,SAAU,CACN,OAAOJ,CACX,EACA,MAAO,CACH,OAAOA,CACX,EACA,KAAKM,EAAU,CACXN,EAAQM,EACRD,EAASC,CAAQ,CACrB,CACJ,CACJ,CAEO,SAASL,EAAMM,EAAU,CAAC,EAAG,CAChC,GAAM,CAAE,WAAAH,EAAY,SAAAC,CAAS,EAAIV,EAAa,EAExCa,EAAS,CAAC,EAEhB,QAASC,EAAI,EAAGA,EAAIF,EAAQ,OAAQE,IAAK,CACrC,IAAMC,EAAOX,EAAiBQ,EAAQE,CAAC,CAAC,EACxCD,EAAO,KAAKE,CAAI,EAChBA,EAAK,WAAW,CAACJ,EAAUK,IAAa,CACpCN,EAASC,EAAUK,EAAW,GAAGF,KAAKE,IAAa,GAAGF,GAAG,CAC7D,CAAC,EAGL,OAAAD,EAAO,cAAgB,GACvBA,EAAO,WAAaJ,EACpBI,EAAO,QAAU,UAAY,CACzB,OAAOA,EAAO,IAAIE,GAAQA,EAAK,QAAQ,CAAC,CAC5C,EACAF,EAAO,QAAU,SAAUI,EAAI,CAC3BA,EAAGJ,CAAM,EACT,QAASC,EAAI,EAAGA,EAAID,EAAO,OAAQC,IAC1BD,EAAOC,CAAC,EAAE,gBACXD,EAAOC,CAAC,EAAIV,EAAiBS,EAAOC,CAAC,CAAC,GAG9CJ,EAASG,EAAO,QAAQ,CAAC,CAC7B,EAEOA,CACX,CAEO,SAASN,EAAMK,EAAU,CAAC,EAAG,CAChC,GAAM,CAAE,WAAAH,EAAY,SAAAC,CAAS,EAAIV,EAAa,EAExCkB,EAAS,CAAC,EAEhB,QAAWC,KAAOP,EACdM,EAAOC,CAAG,EAAIf,EAAiBQ,EAAQO,CAAG,CAAC,EAC3CD,EAAOC,CAAG,EAAE,WAAW,CAACR,EAAUK,IAAa,CAC3CN,EAASC,EAAUK,EAAW,GAAGG,KAAOH,IAAaG,CAAG,CAC5D,CAAC,EAGL,OAAAD,EAAO,cAAgB,GACvBA,EAAO,WAAaT,EACpBS,EAAO,QAAU,UAAY,CACzB,IAAME,EAAU,CAAC,EACjB,QAAWD,KAAOD,EACTC,EAAI,WAAW,GAAG,IACnBC,EAAQD,CAAG,EAAID,EAAOC,CAAG,EAAE,QAAQ,GAG3C,OAAOC,CACX,EACAF,EAAO,KAAO,SAAUC,EAAKd,EAAO,CAChCa,EAAOC,CAAG,EAAIf,EAAiBC,CAAK,EACpCa,EAAOC,CAAG,EAAE,WAAW,CAACR,EAAUK,IAAa,CAC3CN,EAASC,EAAUK,EAAW,GAAGG,KAAOH,IAAaG,CAAG,CAC5D,CAAC,EACDT,EAASQ,EAAOC,CAAG,EAAE,QAAQ,EAAGA,CAAG,CACvC,EAEOD,CACX",
  "names": ["subscription", "subscribers", "subscriber", "data", "makeSubscription", "value", "group", "store", "reactive", "$subscribe", "$publish", "newValue", "initial", "_group", "i", "item", "keyParts", "fn", "_store", "key", "_static"]
}
